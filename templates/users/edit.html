{% extends "header.html" %}
{% load static %}
{% block content %}
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="p-6.5 flex flex-col gap-6">
            <div class="avatar-container flex items-center mb-6">
                <img src="{% static profile.avatar.url %}" alt="User Avatar"
                     class="w-16 h-16 rounded-full object-cover">
                <div class="ml-4">
                    <p class="text-lg font-medium text-black dark:text-white">{{ user.username }}</p>
                    <p class="text-sm text-gray-500">{{ user.email }}</p>
                </div>
            </div>
            <div class="flex flex-col gap-6 xl:flex-row">
                <div class="w-full xl:w-1/2">
                    {% for field in user_form %}
                        <div class="mb-3 block">
                            <label class="mb-3 block text-sm font-medium text-black dark:text-white">
                                {{ field.label }}
                            </label>
                            <div class="relative">
                                {{ field }}
                                {% if field.errors %}
                                {% endif %}
                            </div>
                            {% if field.help_text %}
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
                <div class="w-full xl:w-1/2">
                    {% for field in profile_form %}
                        <div class="mb-3 block">
                            <label class="mb-3 block text-sm font-medium text-black dark:text-white">
                                {{ field.label }}
                            </label>
                            <div class="relative">
                                {{ field }}
                                {% if field.errors %}
                                    <!-- Display field errors -->
                                {% endif %}
                            </div>
                            {% if field.help_text %}
                                <!-- Display field help text -->
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            </div>
            <div class="mb-6 flex justify-between">
                <button class="inline-flex items-center justify-center bg-meta-3 px-10 py-4 text-center font-medium text-white hover:bg-opacity-90 lg:px-8 xl:px-10"
                        type="submit">
                    Update
                </button>
                <button
                        class="rounded p-2 font-medium text-red-600 hover:bg-red-600 hover:text-amber-50"
                        type="button"
                        id="deleteAccountBtn"

                >
                    delete account
                </button>
            </div>
        </div>
    </form>

   <!-- Delete Confirmation Modal -->
    <div x-data="{ showModal: false }" x-cloak>
        <div x-show="showModal" class="fixed inset-0 z-50 flex items-center justify-center overflow-y-auto"
             style="background-color: rgba(0, 0, 0, 0.5);">
            <div class="relative max-w-md mx-auto bg-white rounded-lg shadow-lg p-6">
                <button @click="showModal = false"
                        class="absolute top-2 right-2 text-gray-400 hover:text-gray-600 focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
                <div class="text-center">
                    <h2 class="text-xl font-bold mb-4">Confirm Deletion</h2>
                    <p class="text-gray-700 mb-4">Are you sure you want to delete your account?</p>
                    <div class="flex justify-center">
                        <button @click="deleteAccount" class="px-4 py-2 bg-red-500 text-white rounded-md mr-2">Yes, I'm Sure</button>
                        <button @click="showModal = false" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-md">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>


{% endblock %}

{% block script %}
    <script>
        const currentUserId = '{{ request.user.id }}';
        const deleteAccountUrl = '{% url "delete" %}';
    </script>
    <script src="{% static 'js/delete_account.js' %}"></script>
{% endblock %}